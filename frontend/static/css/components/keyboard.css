/* ─────────────────────────────────────────────
   Keyboard - Virtual keyboard styling
   ───────────────────────────────────────────── */

#keyboard {
  width: 100%;
  /* Allow keyboard to scale wider on large screens for better usability,
     but constrain to reasonable maximum */
  max-width: min(100%, 900px);
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: var(--kb-gap);
  padding-bottom: env(safe-area-inset-bottom);
  touch-action: manipulation;
  flex: 0 0 auto; /* Don't shrink */
  position: relative;
  z-index: var(--z-keyboard);
}

.keyboard-row {
  display: flex;
  justify-content: center;
  gap: var(--kb-gap);
  align-items: stretch;
}

.key {
  /* Use responsive key sizing tokens for smooth scaling across viewports */
  height: var(--key-size);
  width: var(--key-size);
  max-width: var(--key-size);
  /* Use flex to distribute space naturally across keys in each row.
     This allows proper handling of varying key counts per row. */
  flex: 1 1 auto;
  min-width: var(--min-touch-target); /* Ensure minimum touch target */
  border: none;
  background-color: var(--key-bg);
  border-radius: var(--radius);
  font-size: var(--key-font-size);
  font-weight: 800;
  text-transform: uppercase;
  cursor: pointer;
  color: var(--key-text);
  box-shadow: 4px 4px 8px var(--shadow-color-dark),
              -4px -4px 8px var(--shadow-color-light);
  transition: filter 120ms ease, transform 80ms ease, background-color 120ms ease;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 5px;
  user-select: none;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.key.wide { 
  /* Wide keys (Enter, Backspace) span more space using flex-grow */
  flex: 1.5 1 auto;
  max-width: var(--key-size-wide);
  font-size: var(--key-font-size-wide);
  letter-spacing: 0.02em;
}

.key:hover {
  transform: translateY(-1px);
  filter: brightness(1.05);
}

.key:active,
.key.active-key-press {
  box-shadow: inset 2px 2px 5px var(--inset-shadow-dark),
              inset -2px -2px 5px var(--inset-shadow-light);
  transform: translateY(1px);
  filter: brightness(0.95);
}

.key:focus-visible {
  outline: 3px solid rgba(255,255,255,.35);
  outline-offset: 2px;
}

.key.correct,
.key.present,
.key.absent {
  color: white;
  transition: background-color 120ms ease, color 120ms ease, box-shadow 120ms ease;
}

.key.correct {
  background-color: var(--correct-bg);
  box-shadow: 3px 3px 6px var(--correct-shadow-dark),
              -3px -3px 6px var(--correct-shadow-light);
}

.key.present {
  background-color: var(--present-bg);
  box-shadow: 3px 3px 6px var(--present-shadow-dark),
              -3px -3px 6px var(--present-shadow-light);
}

.key.absent {
  background-color: var(--absent-bg);
  box-shadow: 3px 3px 6px var(--absent-shadow-dark),
              -3px -3px 6px var(--absent-shadow-light);
}

/* Keyboard key text and icon handling - always show icon */
.key-text {
  display: none;
}

.key-icon {
  display: inline;
}
