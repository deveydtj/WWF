import{u as c}from"./utils-Z9pyJ2Ng.js";function h(){const e=localStorage.getItem("dark")==="true";document.body.classList.toggle("dark-mode",e)}function p(e){localStorage.setItem("dark",String(e)),h()}function w(){const e=document.getElementById("darkToggle");h(),e.addEventListener("click",()=>{const t=!document.body.classList.contains("dark-mode");p(t)})}function u(e){const t=document.getElementById("ariaLive");t&&(t.textContent=e)}function b(e){const t=document.getElementById("joinError");t&&(t.textContent=e,t.classList.remove("visually-hidden")),u(e)}function y(){const e=document.getElementById("joinError");e&&e.classList.add("visually-hidden")}function L(){const e=document.getElementById("emojiDisplay");if(e){const t=localStorage.getItem("myEmoji");t&&(e.textContent=t)}}function g(e){localStorage.setItem("lastLobby",e)}function k(){return localStorage.getItem("lastLobby")}async function E(){const e=await fetch("/lobby",{method:"POST"}),t=await e.json();e.ok&&t.id?(g(t.id),t.host_token&&localStorage.setItem("hostToken",t.host_token),localStorage.setItem("showInvitePopup",t.id),window.location.hash=`#lobby/${t.id}`):u("Could not create lobby")}async function m(e){(await fetch(`/lobby/${e}/state`)).ok?(g(e),localStorage.removeItem("hostToken"),window.location.hash=`#lobby/${e}`):u("Lobby not found")}async function v(){await E()}function I(){const e=document.getElementById("joinForm"),t=document.getElementById("joinCode"),n=document.getElementById("rejoinChip"),o=k();o&&(n.hidden=!1,n.addEventListener("click",()=>m(o))),t.addEventListener("input",()=>{t.value=t.value.toUpperCase(),/^[A-Za-z0-9]{0,6}$/.test(t.value)?y():b("Use letters and numbers only")}),e.addEventListener("submit",a=>{a.preventDefault();const i=t.value.trim();/^[A-Za-z0-9]{6}$/.test(i)?(y(),m(i)):b("Enter a valid 6 character code")})}function C(){const e=document.getElementById("howToggle"),t=document.getElementById("howContent");!e||!t||e.addEventListener("click",()=>{const n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",String(!n)),t.hidden=n})}async function j(){try{const e=await fetch("/lobbies/network");if(e.ok){const t=await e.json();B(t.lobbies)}else console.warn("Failed to fetch network lobbies")}catch(e){console.warn("Error fetching network lobbies:",e)}}function B(e){const t=document.getElementById("networkLobbies"),n=document.getElementById("networkLobbyList");if(!(!t||!n)){if(e.length===0){t.hidden=!0;return}t.hidden=!1,n.innerHTML="",e.forEach(o=>{const a=document.createElement("div");a.className="network-lobby-item";const i=document.createElement("div");i.className="lobby-info";const r=document.createElement("span");r.className="lobby-code",r.textContent=o.id;const l=document.createElement("span");if(l.className="player-count",l.textContent=`${o.players} player${o.players!==1?"s":""}`,i.appendChild(r),i.appendChild(l),o.your_emoji){const s=document.createElement("span");s.className="your-emoji",s.textContent=o.your_emoji,s.setAttribute("aria-label","Your emoji in this lobby"),i.appendChild(s)}const d=document.createElement("button");d.className="join-network-lobby-btn",d.textContent="Join",d.addEventListener("click",()=>m(o.id)),a.appendChild(i),a.appendChild(d),n.appendChild(a)})}}function S(){w(),I(),C(),L(),j(),c(),window.addEventListener("resize",c),window.visualViewport&&window.visualViewport.addEventListener("resize",c),window.addEventListener("orientationchange",c),document.getElementById("createBtn").addEventListener("click",E),document.getElementById("quickBtn").addEventListener("click",v),f(),window.addEventListener("hashchange",f)}function f(){const e=window.location.hash.match(/^#lobby\/([A-Za-z0-9]{6})$/),t=document.getElementById("landingView"),n=document.getElementById("lobbyView");!t||!n||(e?(t.hidden=!0,n.hidden=!1,(!n.dataset.code||n.dataset.code!==e[1])&&(n.dataset.code=e[1],n.innerHTML=`<iframe src="/lobby/${e[1]}" title="Game lobby"></iframe>`)):(n.hidden=!0,t.hidden=!1))}document.addEventListener("DOMContentLoaded",S);
