import{u as o}from"./utils-Z9pyJ2Ng.js";function u(){const e=localStorage.getItem("dark")==="true";document.body.classList.toggle("dark-mode",e)}function b(e){localStorage.setItem("dark",String(e)),u()}function g(){const e=document.getElementById("darkToggle");u(),e.addEventListener("click",()=>{const t=!document.body.classList.contains("dark-mode");b(t)})}function i(e){const t=document.getElementById("ariaLive");t&&(t.textContent=e)}function c(e){const t=document.getElementById("joinError");t&&(t.textContent=e,t.classList.remove("visually-hidden")),i(e)}function s(){const e=document.getElementById("joinError");e&&e.classList.add("visually-hidden")}function h(){const e=document.getElementById("emojiDisplay");if(e){const t=localStorage.getItem("myEmoji");t&&(e.textContent=t)}}function m(e){localStorage.setItem("lastLobby",e)}function E(){return localStorage.getItem("lastLobby")}async function f(){const e=await fetch("/lobby",{method:"POST"}),t=await e.json();e.ok&&t.id?(m(t.id),t.host_token&&localStorage.setItem("hostToken",t.host_token),window.location.hash=`#lobby/${t.id}`):i("Could not create lobby")}async function r(e){(await fetch(`/lobby/${e}/state`)).ok?(m(e),localStorage.removeItem("hostToken"),window.location.hash=`#lobby/${e}`):i("Lobby not found")}async function w(){await f()}function L(){const e=document.getElementById("joinForm"),t=document.getElementById("joinCode"),n=document.getElementById("rejoinChip"),a=E();a&&(n.hidden=!1,n.addEventListener("click",()=>r(a))),t.addEventListener("input",()=>{t.value=t.value.toUpperCase(),/^[A-Za-z0-9]{0,6}$/.test(t.value)?s():c("Use letters and numbers only")}),e.addEventListener("submit",y=>{y.preventDefault();const d=t.value.trim();/^[A-Za-z0-9]{6}$/.test(d)?(s(),r(d)):c("Enter a valid 6 character code")})}function v(){const e=document.getElementById("howToggle"),t=document.getElementById("howContent");!e||!t||e.addEventListener("click",()=>{const n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",String(!n)),t.hidden=n})}function k(){g(),L(),v(),h(),o(),window.addEventListener("resize",o),window.visualViewport&&window.visualViewport.addEventListener("resize",o),window.addEventListener("orientationchange",o),document.getElementById("createBtn").addEventListener("click",f),document.getElementById("quickBtn").addEventListener("click",w),l(),window.addEventListener("hashchange",l)}function l(){const e=window.location.hash.match(/^#lobby\/([A-Za-z0-9]{6})$/),t=document.getElementById("landingView"),n=document.getElementById("lobbyView");!t||!n||(e?(t.hidden=!0,n.hidden=!1,(!n.dataset.code||n.dataset.code!==e[1])&&(n.dataset.code=e[1],n.innerHTML=`<iframe src="/lobby/${e[1]}" title="Game lobby"></iframe>`)):(n.hidden=!0,t.hidden=!1))}document.addEventListener("DOMContentLoaded",k);
